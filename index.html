<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>부동산 PWA</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="style.css">

  <!-- Naver Maps API Script (Ensure it's loaded before any other code) -->
  <script type="text/javascript" src="https://openapi.naver.com/openapi/v3/maps.js?clientId=g1751tw37y"></script>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database.js"></script>

  <script>
    // Firebase Configuration
    const firebaseConfig = {
      apiKey: "AIzaSyB1X2Y9K9-dQBDXQ7eVxaGKJDQc_ztdWYs",
      authDomain: "real-estate-app-7a001.firebaseapp.com",
      databaseURL: "https://real-estate-app-7a001-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "real-estate-app-7a001",
      storageBucket: "real-estate-app-7a001.appspot.com",
      messagingSenderId: "229808061189",
      appId: "1:229808061189:web:fa083511b468b44e3556c",
      measurementId: "G-TZ4X11LZ57"
    
    };

    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Event Listeners for button actions
    document.getElementById('homeBtn').addEventListener('click', () => {
      console.log("Home button clicked");
      // Handle home button logic
    });

    document.getElementById('mapBtn').addEventListener('click', () => {
      console.log("Map button clicked");
      initMap(); // Initialize Naver Map when the Map button is clicked
    });

    document.getElementById('chatBtn').addEventListener('click', () => {
      console.log("Chat button clicked");
      // Handle chat button logic
    });

    document.getElementById('sellBtn').addEventListener('click', () => {
      console.log("Sell button clicked");
      // Handle sell button logic
    });

    document.getElementById('buyBtn').addEventListener('click', () => {
      console.log("Buy button clicked");
      // Handle buy button logic
    });

    // Naver Map Initialization
    function initMap() {
      console.log('Initializing Naver Map...');
      var map = new naver.maps.Map('map', {
        center: new naver.maps.LatLng(37.5665, 126.9780), // Default to Seoul
        zoom: 12
      });

      // Example data for markers
      const posts = [
        { lat: 37.5665, lng: 126.9780, title: 'Post 1' }
      ];

      posts.forEach(post => {
        new naver.maps.Marker({
          position: new naver.maps.LatLng(post.lat, post.lng),
          map: map,
          title: post.title,
        });
      });
    }
  </script>
</head>
<body>
  <header>
    <h1>부동산 매물 및 매수자 등록 PWA</h1>
  </header>

  <div id="navbar">
    <button id="homeBtn">🏠 Home</button>
    <button id="mapBtn">🗺️ Map</button>
    <button id="chatBtn">💬 Chat</button>
    <button id="sellBtn">🛒 Sell</button>
    <button id="buyBtn">💰 Buy</button>
  </div>

  <!-- Home Section -->
  <section id="homeSection">
    <h2>매물 등록</h2>
    <form id="매물등록폼">
      <label for="종류">종류:</label>
      <input type="text" id="종류" placeholder="예: 아파트">
      <label for="가격">가격 (만원):</label>
      <input type="number" id="가격" placeholder="예: 50000">
      <label for="주소">주소:</label>
      <input type="text" id="주소" placeholder="예: 서울시 종로구 새문안로 68">
      <button type="submit">등록</button>
    </form>
  </section>

  <!-- Map Section -->
  <section id="mapSection">
    <div id="map" style="height: 400px;"></div>
  </section>

  <footer>
    <p>© 2025 부동산 PWA</p>
  </footer>

  <script>
    // Firebase Logic for submitting forms
    document.getElementById('sellForm').addEventListener('submit', (e) => {
      e.preventDefault();
      const itemType = document.getElementById('itemType').value;
      const price = document.getElementById('price').value;
      const address = document.getElementById('address').value;

      const sellRef = db.ref('매물');
      push(sellRef, { itemType, price, address })
        .then(() => {
          alert('Item successfully posted for sale!');
          document.getElementById('sellForm').reset();
        })
        .catch((error) => console.error('Error posting item for sale:', error));
    });

    document.getElementById('buyForm').addEventListener('submit', (e) => {
      e.preventDefault();
      const buyType = document.getElementById('buyType').value;
      const maxPrice = document.getElementById('maxPrice').value;
      const buyAddress = document.getElementById('buyAddress').value;

      const buyRef = db.ref('매수자');
      push(buyRef, { buyType, maxPrice, buyAddress })
        .then(() => {
          alert('Buy request successfully posted!');
          document.getElementById('buyForm').reset();
        })
        .catch((error) => console.error('Error posting buy request:', error));
    });
  </script>
</body>
</html>
