<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¶€ë™ì‚° ì»¤ë®¤ë‹ˆí‹°</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=7k5yxwvvj6"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database.js"></script>
    <style>
        body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }
        header { text-align: center; margin-bottom: 20px; }
        #navbar { display: flex; justify-content: space-around; padding: 10px; background-color: #f0f0f0; }
        button { padding: 10px; border: none; border-radius: 5px; background-color: #007bff; color: white; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        form { display: flex; flex-direction: column; gap: 10px; max-width: 500px; margin: 0 auto; }
        input, textarea { padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        #map { width: 100%; height: 400px; margin-top: 20px; border: 1px solid #ddd; }
        .listing { border: 1px solid #ddd; padding: 10px; margin: 10px 0; border-radius: 4px; }
        .delete-btn { background-color: red; color: white; border: none; padding: 5px; cursor: pointer; }
        .delete-btn:hover { background-color: darkred; }
    </style>
</head>
<body>
    <header><h1>ë¶€ë™ì‚° ë§¤ë„,ë§¤ìˆ˜ ë“±ë¡</h1></header>
    <div id="navbar">
        <button id="homeBtn">ğŸ  í™ˆ</button>
        <button id="mapBtn">ğŸ—ºï¸ ì§€ë„</button>
        <button id="sellBtn">ğŸ¢ ë§¤ë„</button>
        <button id="buyBtn">ğŸ” ë§¤ìˆ˜</button>
        <button id="boardBtn">ğŸ“‹ ê²Œì‹œíŒ</button>
    </div>
    
    <section id="sellSection" style="display: none;">
        <h2>ë§¤ë„ ë“±ë¡</h2>
        <form id="sellForm">
            <label>ì¢…ë¥˜: <input type="text" id="itemType" required></label>
            <label>ë§¤ë„ê°€ê²© (ë§Œì›): <input type="number" id="price" required></label>
            <label>ì£¼ì†Œ: <input type="text" id="addressSell" placeholder="ë„ë¡œëª… ì£¼ì†Œ ì…ë ¥" required>
                <button type="button" onclick="searchAddress('sell')">ì£¼ì†Œ ê²€ìƒ‰</button></label>
            <div id="address-list-sell"></div>
            <label>ë‚´ìš©: <textarea id="sellContent" required></textarea></label>
            <button type="submit">ë“±ë¡í•˜ê¸°</button>
        </form>
    </section>
    
    <section id="buySection" style="display: none;">
        <h2>ë§¤ìˆ˜ ë“±ë¡</h2>
        <form id="buyForm">
            <label>ì¢…ë¥˜: <input type="text" id="buyType" required></label>
            <label>ë§¤ìˆ˜ê°€ê²© (ë§Œì›): <input type="number" id="maxPrice" required></label>
            <label>ì£¼ì†Œ: <input type="text" id="addressBuy" placeholder="ë„ë¡œëª… ì£¼ì†Œ ì…ë ¥" required>
                <button type="button" onclick="searchAddress('buy')">ì£¼ì†Œ ê²€ìƒ‰</button></label>
            <div id="address-list-buy"></div>
            <label>ë‚´ìš©: <textarea id="buyContent" required></textarea></label>
            <button type="submit">ë“±ë¡í•˜ê¸°</button>
        </form>
    </section>
    
    <section id="boardSection" style="display: none;">
        <h2>ê²Œì‹œíŒ</h2>
        <div id="postList"></div>
    </section>
    
    <script>
        function searchAddress(type) {
            let inputId = type === 'sell' ? 'addressSell' : 'addressBuy';
            let listId = type === 'sell' ? 'address-list-sell' : 'address-list-buy';
            let keyword = document.getElementById(inputId).value;
            if (!keyword) { alert("ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”."); return; }
            let apiKey = "U01TX0FVVEgyMDI1MDEzMDIyMDExMDExNTQzNDc=";
            let apiUrl = `https://www.juso.go.kr/addrlink/addrLinkApiJsonp.do?confmKey=${apiKey}&currentPage=1&countPerPage=50&keyword=${encodeURIComponent(keyword)}&resultType=json`;
            $.ajax({
                url: apiUrl,
                type: "GET",
                dataType: "jsonp",
                crossDomain: true,
                success: function (response) {
                    let result = response.results;
                    let listDiv = document.getElementById(listId);
                    listDiv.innerHTML = "";
                    if (result.common.totalCount === "0") {
                        listDiv.innerHTML = "<p>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>";
                        return;
                    }
                    let ul = document.createElement("ul");
                    result.juso.forEach(addr => {
                        let li = document.createElement("li");
                        li.textContent = addr.roadAddr;
                        li.onclick = function () {
                            document.getElementById(inputId).value = addr.roadAddr;
                            listDiv.innerHTML = "";
                        };
                        ul.appendChild(li);
                    });
                    listDiv.appendChild(ul);
                },
                error: function () { alert("ì£¼ì†Œ ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."); }
            });
        }
    </script>
</body>
</html>
