<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>부동산 커뮤니티</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=7k5yxwvvj6"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database.js"></script>
    <style>
        body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }
        header { text-align: center; margin-bottom: 20px; }
        #navbar { display: flex; justify-content: space-around; padding: 10px; background-color: #f0f0f0; }
        button { padding: 10px; border: none; border-radius: 5px; background-color: #007bff; color: white; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        form { display: flex; flex-direction: column; gap: 10px; max-width: 500px; margin: 0 auto; }
        input, textarea { padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        #map { width: 100%; height: 400px; margin-top: 20px; border: 1px solid #ddd; }
        .listing { border: 1px solid #ddd; padding: 10px; margin: 10px 0; border-radius: 4px; }
        .delete-btn { background-color: red; color: white; border: none; padding: 5px; cursor: pointer; }
        .delete-btn:hover { background-color: darkred; }
    </style>
</head>
<body>
    <header><h1>부동산 매도,매수 등록</h1></header>
    <div id="navbar">
        <button id="homeBtn">🏠 홈</button>
        <button id="mapBtn">🗺️ 지도</button>
        <button id="sellBtn">🏢 매도</button>
        <button id="buyBtn">🔍 매수</button>
        <button id="boardBtn">📋 게시판</button>
    </div>
    
    <section id="sellSection" style="display: none;">
        <h2>매도 등록</h2>
        <form id="sellForm">
            <label>종류: <input type="text" id="itemType" required></label>
            <label>매도가격 (만원): <input type="number" id="price" required></label>
            <label>주소: <input type="text" id="addressSell" placeholder="도로명 주소 입력" required>
                <button type="button" onclick="searchAddress('sell')">주소 검색</button></label>
            <div id="address-list-sell"></div>
            <label>내용: <textarea id="sellContent" required></textarea></label>
            <button type="submit">등록하기</button>
        </form>
    </section>
    
    <section id="buySection" style="display: none;">
        <h2>매수 등록</h2>
        <form id="buyForm">
            <label>종류: <input type="text" id="buyType" required></label>
            <label>매수가격 (만원): <input type="number" id="maxPrice" required></label>
            <label>주소: <input type="text" id="addressBuy" placeholder="도로명 주소 입력" required>
                <button type="button" onclick="searchAddress('buy')">주소 검색</button></label>
            <div id="address-list-buy"></div>
            <label>내용: <textarea id="buyContent" required></textarea></label>
            <button type="submit">등록하기</button>
        </form>
    </section>
    
    <section id="boardSection" style="display: none;">
        <h2>게시판</h2>
        <div id="postList"></div>
    </section>
    
    <script>
        function searchAddress(type) {
            let inputId = type === 'sell' ? 'addressSell' : 'addressBuy';
            let listId = type === 'sell' ? 'address-list-sell' : 'address-list-buy';
            let keyword = document.getElementById(inputId).value;
            if (!keyword) { alert("주소를 입력하세요."); return; }
            let apiKey = "U01TX0FVVEgyMDI1MDEzMDIyMDExMDExNTQzNDc=";
            let apiUrl = `https://www.juso.go.kr/addrlink/addrLinkApiJsonp.do?confmKey=${apiKey}&currentPage=1&countPerPage=50&keyword=${encodeURIComponent(keyword)}&resultType=json`;
            $.ajax({
                url: apiUrl,
                type: "GET",
                dataType: "jsonp",
                crossDomain: true,
                success: function (response) {
                    let result = response.results;
                    let listDiv = document.getElementById(listId);
                    listDiv.innerHTML = "";
                    if (result.common.totalCount === "0") {
                        listDiv.innerHTML = "<p>검색 결과가 없습니다.</p>";
                        return;
                    }
                    let ul = document.createElement("ul");
                    result.juso.forEach(addr => {
                        let li = document.createElement("li");
                        li.textContent = addr.roadAddr;
                        li.onclick = function () {
                            document.getElementById(inputId).value = addr.roadAddr;
                            listDiv.innerHTML = "";
                        };
                        ul.appendChild(li);
                    });
                    listDiv.appendChild(ul);
                },
                error: function () { alert("주소 검색 중 오류가 발생했습니다."); }
            });
        }
    </script>
</body>
</html>
